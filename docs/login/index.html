<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Fork About & Find Out — Access</title>

    <style>
      :root{
        --w98-bg: #008080;          /* Win98 teal desktop */
        --w98-face: #c0c0c0;        /* window face */
        --w98-shadow: #808080;      /* dark bevel */
        --w98-hilite: #ffffff;      /* light bevel */
        --w98-text: #000000;
        --w98-title: #000080;       /* titlebar navy */
        --w98-title-text: #ffffff;
      }

      html, body { height: 100%; }

      /* Desktop background */
      body{
        margin: 0;
        background: var(--w98-bg);
        color: var(--w98-text);
        font-family: "MS Sans Serif", Tahoma, Verdana, Arial, sans-serif;
        -webkit-font-smoothing: none;
        -moz-osx-font-smoothing: auto;
        text-rendering: geometricPrecision;
      }

      .wrap{
        min-height: 100%;
        display: grid;
        place-items: center;
        padding: 40px 16px;
      }

      .fineprint{
        font-size: 12px;
        line-height: 1.35;
        margin: 10px 0 0;
        color: #111;
      }
    
      .checkrow{
        display: flex;
        align-items: flex-start;
        gap: 10px;
        margin-top: 12px;
        font-size: 13px;
      }
    
      .checkrow input[type="checkbox"]{
        width: 18px;
        height: 18px;
        margin-top: 2px;
        flex: 0 0 auto;
    
        /* match win98-ish input bevel */
        background: #fff;
        border: 2px solid #000;
        box-shadow:
          inset 2px 2px 0 var(--w98-shadow),
          inset -2px -2px 0 var(--w98-hilite);
      }
    
      .checkrow label{
        margin: 0;            /* override your label default */
        font-size: 13px;
        line-height: 1.3;
        cursor: pointer;
        user-select: none;
      }
      
      /* Win98 window */
      .window{
        width: min(520px, 100%);
        background: var(--w98-face);
        border: 2px solid var(--w98-hilite);
        box-shadow:
          inset -2px -2px 0 var(--w98-shadow),
          inset  2px  2px 0 var(--w98-hilite),
          2px 2px 0 #000;
      }

      /* Title bar */
      .titlebar{
        background: var(--w98-title);
        color: var(--w98-title-text);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 6px 8px;
        font-weight: 700;
        user-select: none;
      }

      .titlebar-left{
        display: flex;
        align-items: center;
        gap: 8px;
        min-width: 0;
      }

      .titlebar-left .title{
        font-size: 13px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }

      .titlebar-controls{
        display: flex;
        gap: 6px;
      }

      .ctrl{
        width: 18px;
        height: 18px;
        background: var(--w98-face);
        border: 2px solid var(--w98-hilite);
        box-shadow:
          inset -2px -2px 0 var(--w98-shadow),
          inset  2px  2px 0 var(--w98-hilite);
      }

      /* Window body */
      .content{
        padding: 14px 16px 16px;
      }

      .header{
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 12px;
      }

      .logo{
        width: 56px;
        height: 56px;
        border-radius: 8px;
        background: #fff;
        object-fit: cover;
        image-rendering: pixelated;
        border: 2px solid var(--w98-hilite);
        box-shadow:
          inset -2px -2px 0 var(--w98-shadow),
          inset  2px  2px 0 var(--w98-hilite);
      }

      h1{
        margin: 0;
        font-size: 20px;
        font-weight: 700;
      }

      /* Form */
      form{ margin: 0; }

      label{
        display: block;
        font-size: 13px;
        margin: 12px 0 6px;
      }

      input{
        width: 100%;
        box-sizing: border-box;
        padding: 10px;
        font-size: 14px;
        background: #ffffff;
        border: 2px solid #000;
        box-shadow:
          inset 2px 2px 0 var(--w98-shadow),
          inset -2px -2px 0 var(--w98-hilite);
      }

    <p class="fineprint">
      We’ll only email you about access. Updates are optional.
    </p>
    
    <div class="checkrow">
      <input id="updates" name="updates" type="checkbox" />
      <label for="updates">
        Send me updates about new interviews and events.
      </label>
    </div>

      button{
        width: 100%;
        box-sizing: border-box;
        margin-top: 14px;
        padding: 10px;
        font-size: 14px;
        background: var(--w98-face);
        border: 2px solid var(--w98-hilite);
        box-shadow:
          inset -2px -2px 0 var(--w98-shadow),
          inset  2px  2px 0 var(--w98-hilite);
        cursor: pointer;
      }

      button:active{
        box-shadow:
          inset 2px 2px 0 var(--w98-shadow),
          inset -2px -2px 0 var(--w98-hilite);
      }

      button:disabled{
        opacity: 0.65;
        cursor: not-allowed;
      }

      /* Hidden message area: keep functionality, but don't show UI text unless needed */
      #msg{
        margin: 0;
        height: 0;
        overflow: hidden;
        padding: 0;
      }
      .err{ color: #b00020; }
      .ok{ color: #0a7a0a; }

      /* Optional: subtle “screen” texture */
      .window{
        background-image: linear-gradient(rgba(0,0,0,0.02), rgba(0,0,0,0.02));
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <div class="window" role="dialog" aria-label="FAFO Access">
        <div class="titlebar">
          <div class="titlebar-left">
            <div class="title">Fork About &amp; Find Out</div>
          </div>
          <div class="titlebar-controls" aria-hidden="true">
            <div class="ctrl" title="Minimize"></div>
            <div class="ctrl" title="Maximize"></div>
            <div class="ctrl" title="Close"></div>
          </div>
        </div>

        <div class="content">
          <div class="header">
            <img class="logo" src="/assets/fafo-logo.png" alt="FAFO logo" />
            <h1>Get access</h1>
          </div>

          <form id="f">
            <label for="name">Name</label>
            <input
              id="name"
              name="name"
              type="text"
              placeholder="Ada Lovelace"
              autocomplete="name"
              required
            />

            <label for="email">Email</label>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="you@domain.com"
              autocomplete="email"
              required
            />

            <button id="btn" type="submit">Continue</button>

            <!-- Keep for JS status updates, but hidden visually -->
            <p id="msg" class="hint" aria-live="polite"></p>
          </form>
        </div>
      </div>
    </div>

    <script>
      const f = document.getElementById("f");
      const nameEl = document.getElementById("name");
      const emailEl = document.getElementById("email");
      const msg = document.getElementById("msg");
      const btn = document.getElementById("btn");
      const updatesEl = document.getElementById("updates");

      const params = new URLSearchParams(window.location.search);
      const next = params.get("next") || "/";

      function setMsg(text, type) {
        msg.textContent = text || "";
        msg.className = type ? type : "hint";
      }

      f.addEventListener("submit", async (e) => {
        e.preventDefault();
        setMsg("Saving…", "hint");
        btn.disabled = true;

      const payload = {
        name: nameEl.value.trim(),
        email: emailEl.value.trim(),
        marketing_opt_in: !!updatesEl.checked,
        consent_version: "login_updates_v1"
      };


        try {
          const res = await fetch("/api/subscribe", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload),
          });

          const data = await res.json().catch(() => ({}));

          if (!res.ok || !data.ok) {
            const err = data.error || data.details || "Something went wrong.";
            setMsg("❌ " + err, "err");
            btn.disabled = false;
            return;
          }

          setMsg("✅ You’re in. Redirecting…", "ok");
          localStorage.setItem("fafo_access", "1");
          window.location.assign(next);
        } catch (err) {
          setMsg("❌ Network error. Try again.", "err");
          btn.disabled = false;
        }
      });
    </script>
  </body>
</html>

